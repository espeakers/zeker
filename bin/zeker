#!/usr/bin/env node

var _ = require('lodash');

var error = function (msg) {
    console.error('[error]', msg);
    process.exit(1);
};

try {
    var package_json = require(process.cwd() + '/package.json');
} catch (e) {
    error('You must be in the same directory as package.json');
}
if (!_.has(package_json, 'zeker')) {
    error('Could not find configuration for "zeker" in your package.json');
}
var zeker = package_json.zeker;

var args = process.argv.slice(2);

var build_types = {
    watch: require('../watch'),
    production: require('../production')
};

if (_.has(build_types, args[0])) {
    build_types[args[0]](zeker, _.rest(args));
} else {
    console.log('USAGE:');
    console.log('   zeker watch');
    console.log('   zeker production');
    process.exit(1);
}
